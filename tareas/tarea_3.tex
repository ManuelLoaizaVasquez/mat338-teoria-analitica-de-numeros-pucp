\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amsfonts,latexsym,amsthm,amssymb,amsmath,amscd,euscript}
\usepackage{mathtools}
\usepackage{framed}
% Descomentar fullpage cuando se quiera utilizar menos margen horizontal
%\usepackage{fullpage}
\usepackage{hyperref}
    \hypersetup{colorlinks=true,citecolor=blue,urlcolor =black,linkbordercolor={1 0 0}}

\newenvironment{statement}[1]{\smallskip\noindent\color[rgb]{1.00,0.00,0.50} {\bf #1.}}{}
\allowdisplaybreaks[1]

\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

% Comandos para teoremas, definiciones, ejemplos, lemas, etc. para sus respectivos body types.
\renewcommand*{\proofname}{Prueba}
\renewcommand{\contentsname}{Contenido}

\newtheorem{theorem}{Teorema}
\newtheorem*{proposition}{Proposici\'on}
\newtheorem{lemma}[theorem]{Lema}
\newtheorem{corollary}[theorem]{Corolario}
\newtheorem{conjecture}[theorem]{Conjetura}
\newtheorem*{postulate}{Postulado}
\theoremstyle{definition}
\newtheorem{defn}[theorem]{Definici\'on}
\newtheorem{example}[theorem]{Ejemplo}

\theoremstyle{remark}
\newtheorem*{remark}{Observaci\'on}
\newtheorem*{notation}{Notaci\'on}
\newtheorem*{note}{Nota}

% Define tus comandos para hacer la vida más fácil.
\newcommand{\BR}{\mathbb R}
\newcommand{\BC}{\mathbb C}
\newcommand{\BF}{\mathbb F}
\newcommand{\BQ}{\mathbb Q}
\newcommand{\BZ}{\mathbb Z}
\newcommand{\BN}{\mathbb N}

\title{MAT338 Teor\'ia Anal\'itica de N\'umeros}
\author{Manuel Loaiza Vasquez}
\date{Ciclo 2020-1}

\begin{document}

\maketitle

\vspace*{-0.25in}
\centerline{Pontificia Universidad Cat\'olica del Per\'u}
\centerline{Lima, Per\'u}
\centerline{\href{mailto:manuel.loaiza@pucp.edu.pe}{{\tt manuel.loaiza@pucp.edu.pe}}}
\vspace*{0.15in}

\begin{framed}
\'Ultima tarea del curso de T\'opicos de An\'alisis de la Especialidad de Matem\'aticas dictado en la Facultad de Ciencias e Ingenier\'ia en la Pontificia Universidad Cat\'olica del Per\'u (PUCP) por Alfredo Poirier Schmitz en el ciclo 2020-1.
\end{framed}

\begin{statement}{1}
Para todo n\'umero real $x$ mayor o igual a $1$ se cumple la f\'ormula de Selberg
$$\sum_{p \leq x} \ln^2(p) + \sum_{pq \leq x} \ln(p) \ln(q) = 2x\ln(x) + O(x).$$
\end{statement}
 
\begin{lemma}
Para todo $x \geq 1$ tenemos
$$\sum_{n \leq x} \frac{1}{n} = \ln x + \gamma + O\left(\frac{1}{x}\right).$$
\end{lemma}

\begin{lemma}
Para todo $x \geq 1$ tenemos
$$\sum_{n \leq x} \ln n = x\ln x - x + O(\ln x).$$
\end{lemma}

\begin{lemma}
Para toda funci\'on aritm\'etia $f$ se cumple
$$\sum_{n \leq x} \sum_{d \mid n} f(d) = \sum_{n \leq x} f(n) \floor{\frac{x}{n}}.$$
\end{lemma}

\begin{lemma}
Para todo n\'umero real $x$ tenemos
$$\floor{x} = x + O(1).$$
\end{lemma}

\begin{proof}
Sea $x = n + r$ un n\'umero real no negativo, con $n \in \BZ$ y $0 \leq r < 1$. De esta manera, por definici\'on de m\'aximo entero tenemos
\begin{align*}
\floor{x} &= n \\
&= x - r \\
&= x + O(1).
\end{align*}
Concluimos trivialmente que $\floor{x} = x + O(1)$.
\end{proof}

\begin{lemma}
Para todo $x \geq 1$ tenemos
$$\Psi(x) = O(x).$$
\end{lemma}

\begin{proof}
Utilizar\'e teorema de Chebyshev obtenido en la clase en la cual desarrollamos el paper \textit{Elementary methods in the study of the distribution of prime numbers} de Harold Diamond
$$A \leq \liminf \frac{\Psi(x)}{x} \leq \limsup \frac{\Psi(x)}{x} \leq \frac{6A}{5}$$
con $A = -\frac{\ln 1}{1} + \frac{\ln 2}{2} + \frac{\ln 3}{3} + \frac{\ln 5}{5} - \frac{\ln 30}{30} \approx 0.92129202293409078091340844996160...$
Para analizar el comportamiento asint\'otico nos centraremos en la parte derecha de la desigualdad reescribi\'endola con valor absoluto ya que es una funci\'on positiva
$$\limsup \frac{|\Psi(x)|}{x} \leq \frac{6A}{5}.$$
Por definici\'on, sabemos que existe un $n_0$ a partir del cual
$$\frac{|\Psi(x)|}{x} \leq \frac{6A}{5}$$
para todo $x > n_0$. Pasamos a multiplicar la funci\'on lineal y obtenemos
$$|\Psi(x)| \leq \left(\frac{6A}{5}\right) x$$
con $\frac{6A}{5} > 0$, lo cual denotamos con $\Psi(x) = O(x)$.
\end{proof}

\begin{lemma}
La funci\'on de Mangoldt se puede expresar como el siguiente producto de Dirichlet
$$\Lambda = \mu * \ln.$$
\end{lemma}

\begin{proof}
Sabemos que $\Lambda * 1 = \ln$ y aplicamos los propiedades del producto de Dirichlet
\begin{align*}
(\Lambda * 1) * \mu &= \ln * \mu \\
\Lambda * (1 * \mu) &= \ln * \mu \\
\Lambda * \mathbb{U} &= \ln * \mu \\
\Lambda &= \ln * \mu \\
\Lambda &= \mu * \ln.
\end{align*}
Concluimos que $\Lambda = \mu * \ln$.
\end{proof}

\begin{lemma}
Para todo $x \geq 1$ tenemos
$$\sum_{n \leq x} \frac{\Lambda(n)}{n} = \ln x + O(1).$$
\end{lemma}

\begin{proof}
Sabemos que $\ln = \Lambda * 1$, por lo tanto, desarrollamos
\begin{align*}
\ln n &= \sum_{d \mid n} \Lambda(d) \\
\sum_{n \leq x} \ln n &= \sum_{n \leq x} \sum_{d \mid n} \Lambda(d).
\end{align*}
Del Lema 3 obtenemos
\begin{align*}
\sum_{n \leq x} \ln n &= \sum_{n \leq x} \Lambda(n) \floor{\frac{x}{n}}
\end{align*}
y utilizando el Lema 4 conseguimos
\begin{align*}
\sum_{n \leq x} \ln n &= \sum_{n \leq x} \Lambda(n) \left(\frac{x}{n} + O(1)\right) \\
&= x \sum_{n \leq x} \frac{\Lambda(n)}{n} + O\left(\sum_{n \leq x} \Lambda(x) \right) \\
&= x \sum_{n \leq x} \frac{\Lambda(n)}{n} + O(\Psi(x)).
\end{align*}
La astucia de Chebyshev es la que permite mejorar el estimado que obtuvimos en clase de 
$\Psi(x) = \vartheta(x) + O(\sqrt{x} \ln^2 x)$ con $\vartheta(x) = O(x \ln x)$ 
por $\Psi(x) = O(x)$ gracias al Lema 5.
Utilizando este poderoso teorema de Chebyshev y aplicando el Lema 2 en la suma acumulada de logaritmos conseguimos
\begin{align*}
x\ln x - x + O(\ln x) &= x \sum_{n \leq x} \frac{\Lambda(n)}{n} + O(x)
\end{align*}
y despejamos
\begin{align*}
\sum_{n \leq x} \frac{\Lambda(n)}{n} &= \frac{x \ln x}{x} - 1 + O\left(\frac{\ln x}{x}\right) + O(1) \\
&= \ln x - 1 + O(1) + O\left(\frac{\ln x}{x}\right) \\
&\leq \ln x - 1 + c_0 + O(1) \\
&\leq \ln x + c_1 \\
&= \ln x + O(1).
\end{align*}
Concluimos que $\sum_{n \leq x} \frac{\Lambda(n)}{n} = \ln x + O(1)$.
\end{proof}

\begin{lemma}
Para todo $f, g : [1, \infty) \to \BR$ con $g(x) = \sum_{n \leq x} f\left(\frac{x}{n}\right) \ln x$ tenemos
$$\sum_{n \leq x} \mu(n) g\left(\frac{x}{n}\right) = f(x) \ln(x) + \sum_{n \leq x} f\left(\frac{x}{n}\right) \Lambda(n).$$
\end{lemma}

\begin{proof}
Desarrollemos la sumatoria que queremos analizar
\begin{align*}
\sum_{n \leq x} \mu(n) g\left(\frac{x}{n}\right) &= \sum_{cd \leq x} \mu(c)g(d) \\
&= \sum_{cd \leq x} \mu(c) \sum_{e \leq d} f\left(\frac{d}{e}\right) \ln(d) \\
&= \sum_{cd \leq x} \mu(c) \ln\left(\frac{x}{c}\right) f \left(\frac{x}{cd}\right) \\
&= \sum_{n \leq x} f\left(\frac{x}{n}\right) \sum_{d \mid n} \mu(d) \ln\left(\frac{x}{n}\right) \\
&= \sum_{n \leq x} f\left(\frac{x}{n}\right) \sum_{d \mid n} \mu(d) \left[\ln \left(\frac{x}{n}\right) + \ln\left(\frac{n}{d}\right)\right] \\
&= \left[\sum_{n \leq x} f\left(\frac{x}{n}\right) \ln\left(\frac{x}{n}\right) \sum_{d \mid n} \mu(d)\right]
+  \left[\sum_{n \leq x} f\left(\frac{x}{n}\right) \sum_{d \mid n} \mu(d) \ln\left(\frac{n}{d}\right)\right].
\end{align*}
Asimismo, sabemos que $\mu * 1 = \mathbb{U}$ y
sabemos que el \'unico valor de $\mathbb{U}$ distinto de cero se obtiene en uno.
Por consiguiente, la igualdad se reduce a
\begin{align*}
\sum_{n \leq x} \mu(n)g\left(\frac{x}{n}\right) &= f(x)\ln x + \sum_{n \leq x} f\left(\frac{x}{n}\right) (\mu * \ln)(n).
\end{align*}
Finalmente, utilizamos el Lema $6$ para concluir que $\sum_{n \leq x} \mu(n)g\left(\frac{x}{n}\right) = f(x)\ln x + \sum_{n \leq x} f\left(\frac{x}{n}\right)\Lambda(n)$.
\end{proof}

\begin{lemma}
Para todo $x \geq 1$ tenemos
$$\ln^2 x = O(\sqrt{x}).$$
\end{lemma}

\begin{proof}
Sabemos que para todo $x \geq 1$ se cumple que $x > \ln x$ analizando simplemente la derivada de $x - \ln x$.
\begin{align*}
\ln^2 x &= \ln^2 ((x ^ {\frac{1}{4}}) ^ 4) \\
&= 16 \ln^2 (x ^ {\frac{1}{4}}) \\
&< 16 (x ^ {\frac{1}{4}}) ^ 2 \\
&= 16 \sqrt{x}.
\end{align*}
Por lo tanto, concluimos que $\ln^2 x = O(\sqrt{x})$.
\end{proof}

\begin{lemma}
Para todo $x \geq 1$ tenemos
$$\Psi(x) \ln x + \sum_{n \leq x} \Psi\left(\frac{x}{n}\right)\Lambda(n) = 2x\ln x + O(x).$$
\end{lemma}

\begin{proof}
Para poder utilizar el Lema 8, debemos definir convenientemente la funci\'on $f : [1, \infty) \to \BR$ como
$$f(x) = \Psi(x) - x + \gamma + 1.$$
Antes de aplicar el Lema 8 le daremos forma a la funci\'on $g(x) = \sum_{n \leq x} f\left(\frac{x}{n}\right)\ln x$
\begin{align*}
\sum_{n \leq x} f\left(\frac{x}{n}\right)\ln x &= \sum_{n \leq x} \left(\Psi\left(\frac{x}{n}\right) - \frac{x}{n} + \gamma + 1\right) \ln x \\
&= \sum_{n \leq x} \Psi\left(\frac{x}{n}\right) \ln x - x \ln x \sum_{n \leq x} \frac{1}{n} + (\gamma + 1) \ln x \sum_{n \leq x} 1.
\end{align*}
Analicemos por separado a cada sumatoria. Primero $\sum_{n \leq x} \Psi\left(\frac{x}{n}\right)$
\begin{align*}
\sum_{n \leq x} \Psi\left(\frac{x}{n}\right) &= \sum_{n \leq x} \sum_{d \leq \frac{x}{n}} \Lambda(d) \\
&= \sum_{n \leq x} \sum_{d \mid n} \Lambda(d) \\
&= \sum_{n \leq x} (\Lambda * 1)(n) \\
&= \sum_{n \leq x} \ln n
\end{align*}
el cual es igual a $x\ln x - x + O(\ln x)$ por el Lema 2 y multiplic\'andole el logaritmo obtenemos
$$\sum_{n \leq x} \Psi\left(\frac{x}{n}\right)\ln x = x \ln^2 x - x \ln x + O(\ln^2 x).$$
Ahora analicemos la segunda sumatoria utilizando el Lema 1
\begin{align*}
-x \ln x \sum_{n \leq x} \frac{1}{n} &= -x \ln x \left(\ln x + \gamma + O\left(\frac{1}{x}\right)\right) \\
&= -x \ln^2 x - \gamma x \ln x + O(\ln x).
\end{align*}
Finalmente, analicemos la tercera sumatorio utilizando el Lema 4
\begin{align*}
(\gamma + 1) \ln x \sum_{n \leq x} 1 &= (\gamma + 1) \ln x \floor{x} \\
&= (\gamma + 1) \ln x (x + O(1)) \\
&= (\gamma + 1) x \ln x + O(\ln x).
\end{align*}
Juntando los tres resultados obtenemos
\begin{align*}
g(x) &= x \ln^2 x - x \ln x + O(\ln^2 x) - x \ln^2 x - \gamma x \ln x + O(\ln x) + (\gamma + 1) x \ln x + O(\ln x) \\
&= O(\ln^2 x) + O(\ln x) \\
&= O(\ln^2 x)
\end{align*}
Utilizando el Lema 8 obtenemos la igualdad
$$\sum_{n \leq x} \mu(n) g\left(\frac{x}{n}\right) = (\Psi(x) - x + \gamma + 1) \ln x + \sum_{n \leq x} \left(\Psi\left(\frac{x}{n}\right) - \frac{x}{n} + \gamma + 1\right) \Lambda(n)$$
y analizaremos ambos lados de la desigualdad por separado.
Utilizando la desigualdad triangular en la secci\'on de la izquierda y luego el hecho de que $g(x) = O(\ln^2 x)$ obtenemos
\begin{align*}
\sum_{n \leq x} \mu(n) g\left(\frac{x}{n}\right) &\leq \sum_{n \leq x} g\left(\frac{x}{n}\right) \\
&= O\left(\sum_{n \leq x} g\left(\frac{x}{n}\right)\right) \\
&= O\left(\sum_{n \leq x} \ln^2 \left(\frac{x}{n}\right)\right).
\end{align*}
Utilizamos el Lema 9 para conseguir
\begin{align*}
\sum_{n \leq x} \mu(n) g\left(\frac{x}{n}\right) &= O\left(\sum_{n \leq x} \sqrt{\frac{x}{n}}\right) \\
&= O\left(\sqrt{x} \sum_{n \leq x} \frac{1}{\sqrt{n}}\right).
\end{align*}
Ahora utilizar\'e otro teorema que probamos en la secci\'on en la cual estudiamos a la funci\'on $\zeta$ de Riemann
$$\sum_{n \leq x} \frac{1}{n^\sigma} = \frac{x^{1 - \sigma}}{1 - \sigma} + O(1) = O(x ^ {1 - \sigma}), 0 < \sigma < 1$$
para el caso particular cuando $\sigma = \frac{1}{2}$.
\begin{align*}
\sum_{n \leq x} \mu(n) g\left(\frac{x}{n}\right) &= O(\sqrt{x}\sqrt{x}) \\
&= O(x).
\end{align*}
Ahora desarrollar\'e la parte de la derecha de la igualdad inicial
\end{proof}

\begin{lemma}
Para todo $x \geq 1$ y $p$ un n\'umero primo tenemos
$$\vartheta(x)\ln x + \sum_{p \leq x} \vartheta\left(\frac{x}{p}\right)\ln p = 2x\ln x + O(x).$$
\end{lemma}

\begin{proof}
\end{proof}

\begin{theorem}[F\'ormula Asint\'otica de Selberg]
Para todo $x \geq 1$ y $p$, $q$ n\'umeros primos distintos tenemos
$$\sum_{p \leq x} \ln^2 p + \sum_{pq \leq x} \ln p \ln q = 2x\ln x + O(x).$$
\end{theorem}

\begin{proof}
\end{proof}

\end{document}